---
title: "[Effective Java] Item 7"
date: 2023-02-02 09:00:00 +0900
categories: [Study, Effective Java]
tags: [Java, Effective Java]
---

# Effective Java - Item 7

<aside>
ğŸ’¡ ë‹¤ ì“´ ê°ì²´ ì°¸ì¡°ë¥¼ í•´ì œí•˜ë¼

</aside>

ìë°”ì²˜ëŸ¼ ê°€ë¹„ì§€ ì»¬ë ‰í„°ë¥¼ ê°–ì¶˜ ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ë©”ëª¨ë¦¬ ê´€ë¦¬ì— ì‹ ê²½ ì“°ì§€ ì•Šì•„ë„ ëœë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆì§€ë§Œ, ì ˆëŒ€ ë¬´ì‹œí•´ì„œëŠ” ì•ˆëœë‹¤.

```java
import java.util.Arrays;
import java.util.EmptyStackException;

public class Stack {
	private Object[] elements;
	private int size = 0;
	private static final int DEFAULT_INITIAL_CAPACITY = 16;
	
	public Stack() {
		elements = new Object[DEFAULT_INITIAL_CAPACITY];
	}
	
	public void push(Object e) {
		ensureCapacity();
		elements[size++] = e;
	}
	
	public Object pop() {
		if (size == 0) 
			throw new EmptyStackException();
		return elements[--size];
	}
	
	public void ensureCapacity() {
		if (elements.length == size) 
			elements = Arrays.copyOf(elements, 2 * size + 1);
	}
}
```

â†’ ìŠ¤íƒì„ êµ¬í˜„í•œ ê°„ë‹¨í•œ ì½”ë“œ

ìœ„ ì½”ë“œëŠ” **ìŠ¤íƒ**ì„ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•œ ì½”ë“œì´ë‹¤.

ì–¸ëœ» ë³´ë©´ ì•„ë¬´ëŸ° ë¬¸ì œê°€ ì—†ëŠ” ì½”ë“œë¼ê³  ìƒê°í•˜ê¸° ì‰½ì§€ë§Œ, í•´ë‹¹ ì½”ë“œì—ì„œëŠ” ìŠ¤íƒì—ì„œ êº¼ë‚´ì§„ ê°ì²´ë“¤ì„ ê°€ë¹„ì§€ ì»¬ë ‰í„°ê°€ íšŒìˆ˜í•˜ì§€ ì•ŠëŠ”ë‹¤.

ìŠ¤íƒì´ ë°°ì—´ì—ì„œ ì—¬ì „íˆ ê·¸ ê°ì²´ë“¤ì„ ì°¸ì¡°í•˜ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤. ì´ë ‡ê²Œ ê°ì²´ ì°¸ì¡°ë¥¼ í•˜ë‚˜ ì‚´ë ¤ë‘ë©´ í•´ë‹¹ ê°ì²´ ë¿ ì•„ë‹ˆë¼ ê·¸ ê°ì²´ê°€ ì°¸ì¡°í•˜ê³  ìˆëŠ” ëª¨ë“  ê°ì²´ë¥¼ íšŒìˆ˜ í•˜ì§€ ëª»í•œë‹¤.

ë•Œë¬¸ì— ê³„ì†í•´ì„œ ì‹¤í–‰ëœë‹¤ë©´ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì˜ í™œë™ê³¼ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ëŠ˜ì–´ë‚˜ ì„±ëŠ¥ì´ ì €í•˜ëœë‹¤.

ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ì‹¬í•œ ê²½ìš°ì—ëŠ” *ë””ìŠ¤í¬ í˜ì´ì§•*ì´ë‚˜ *OutOfMemoryError*ê°€ ë°œìƒí•˜ì—¬ ì˜ˆê¸°ì¹˜ ì•Šê²Œ í”„ë¡œê·¸ë¨ì´ ë  ìˆ˜ë„ ìˆë‹¤.

ì´ëŸ¬í•œ ë¬¸ì œì˜ í•´ë²•ì€ ë°”ë¡œ ë‹¤ ì“´ ê°ì²´ëŠ” null ì²˜ë¦¬í•˜ì—¬ ì°¸ì¡°ë¥¼ í•´ì œí•˜ëŠ” ê²ƒì´ë‹¤.

```java
public Object pop() {
	if (size == 0)
	  throw new EmptyStackException();
	Object result = elements[--size];
	element[size] = null; // ë‹¤ ì“´ ê°ì²´ ì°¸ì¡° í•´ì œ
	return result;
}
```

ìŠ¤íƒì€ ìì²´ì ìœ¼ë¡œ ë©”ëª¨ë¦¬ë¥¼ ê´€ë¦¬í•˜ê³ , ë°°ì—´ì˜ í™œì„±í™” ì˜ì—­ì— ì†í•œ ê°ì²´ ë§Œì„ ì‚¬ìš©í•˜ê³  ë¹„í™œì„±í™” ì˜ì—­ì€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë° ê°€ë¹„ì§€ ì»¬ë ‰í„°ëŠ” ì´ ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ê°€ ì—†ë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— null ì²˜ë¦¬ë¥¼ í†µí•´ ê°€ë¹„ì§€ ì»¬ë ‰í„°ì—ê²Œ ì´ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì•¼ í•œë‹¤.

ì¼ë°˜ì ìœ¼ë¡œ ìŠ¤íƒì²˜ëŸ¼ ìê¸° ë©”ëª¨ë¦¬ë¥¼ ì§ì ‘ ê´€ë¦¬í•˜ëŠ” í´ë˜ìŠ¤ë¼ë©´ ê°ì²´ë¥¼ ë‹¤ ì‚¬ìš©í•œ ì¦‰ì‹œ null ì²˜ë¦¬í•˜ì—¬ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ì— ì£¼ì˜í•´ì•¼ í•œë‹¤.

ë‹¤ë§Œ í•­ìƒ ëª¨ë“  ê°ì²´ë¥¼ ì¼ì¼ì´ null ì²˜ë¦¬ë¥¼ í•˜ëŠ” ê²ƒì€ í”„ë¡œê·¸ë¨ì„ ì§€ì €ë¶„í•˜ê²Œ ë§Œë“¤ ë¿ì´ë¯€ë¡œ ê°ì²´ ì°¸ì¡°ë¥¼ null ì²˜ë¦¬í•˜ëŠ” ì¼ì€ ì˜ˆì™¸ì ì¸ ê²½ìš°ì—¬ì•¼ í•œë‹¤.

ê°ì²´ ì°¸ì¡°ë¥¼ í•´ì œí•˜ëŠ” ê°€ì¥ ì¢‹ì€ ë°©ë²•ì€ ê·¸ ì°¸ì¡°ë¥¼ ë‹´ì€ ë³€ìˆ˜ë¥¼ ìœ íš¨ ë²”ìœ„(Scope) ë°–ìœ¼ë¡œ ë°€ì–´ë‚´ëŠ” ê²ƒì´ë‹¤.

**ìºì‹œ** ì—­ì‹œ ìê¸° ë©”ëª¨ë¦¬ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ë¥¼ ì¼ìœ¼í‚¨ë‹¤.

ë§Œì•½ keyë¥¼ ì°¸ì¡°í•˜ëŠ” ë™ì•ˆì—ë§Œ entryê°€ ì‚´ì•„ìˆìœ¼ë©´ ë˜ëŠ” ìºì‹œë¼ë©´ `WeakHashMap`ì„ ì‚¬ìš©í•˜ì—¬ ìºì‹œë¥¼ ìƒì„±í•˜ì. ë‹¤ ì“´ entryëŠ” ê·¸ ì¦‰ì‹œ ìë™ìœ¼ë¡œ ì œê±°ëœë‹¤.

í•˜ì§€ë§Œ ëŒ€ë¶€ë¶„ ìºì‹œ ì—”íŠ¸ë¦¬ì˜ ìœ íš¨ ê¸°ê°„ì„ ì •í™•íˆ ì •ì˜í•˜ê¸°ê°€ ì–´ë µë‹¤. ê·¸ë˜ì„œ ìºì‹œì— ë„£ì€ ì‹œê°„ì´ ê¸¸ìˆ˜ë¡ ì—”íŠ¸ë¦¬ì˜ ê°€ì¹˜ë¥¼ ë–¨ì–´ëœ¨ë¦¬ëŠ” ë°©ì‹ì„ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤.

ì´ëŸ° ë°©ì‹ì—ì„œëŠ” ScheduledThreadPoolExcutor ê°™ì€ ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ë¶€ìˆ˜ ì‘ì—…ìœ¼ë¡œ ì—”íŠ¸ë¦¬ë¥¼ ì²­ì†Œí•´ì£¼ì–´ì•¼ í•œë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ listenerì™€ callback ì—­ì‹œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ì¼ì–´ë‚˜ëŠ” ì£¼ë²”ì´ë‹¤.

í´ë¼ì´ì–¸íŠ¸ê°€ ì½œë°±ì„ ë“±ë¡ë§Œ í•˜ê³  ëª…í™•í•˜ê²Œ í•´ì§€í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´, ë¬´ì–¸ê°€ ì¡°ì¹˜í•´ì£¼ì§€ ì•ŠëŠ” ì´ìƒ ê³„ì†í•´ì„œ ìŒ“ì—¬ê°„ë‹¤. ì´ëŸ´ ë•Œ ì½œë°±ì„ ì•½í•œ ì°¸ì¡°(weak reference)ë¡œ ì €ì¥í•˜ë©´ ê°€ë¹„ì§€ ì»¬ë ‰í„°ê°€ ì§ì ‘ ìˆ˜ê±°í•´ê°ˆ ìˆ˜ ìˆë‹¤.

> ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ëŠ” ê²‰ìœ¼ë¡œ ì˜ ë“œëŸ¬ë‚˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë°œê²¬í•˜ê¸°ê°€ ì–´ë µë‹¤.
ì² ì €í•œ ì½”ë“œ ë¦¬ë·°ë‚˜ í™ í”„ë¡œíŒŒì¼ëŸ¬ ê°™ì€ ë””ë²„ê¹… ë„êµ¬ë¥¼ ë™ì›í•´ì•¼ë§Œ ë°œê²¬í•˜ëŠ” ê²½ìš°ë„ ìˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì˜ˆë°©ë²•ì„ ì² ì €íˆ ìµí˜€ë‘ëŠ” ê²ƒì´ ê°€ì¥ ì¤‘ìš”í•˜ë‹¤.
>